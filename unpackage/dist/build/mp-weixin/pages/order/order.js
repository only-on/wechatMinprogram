(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"28cd":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;a(o("9f36a"));function a(t){return t&&t.__esModule?t:{default:t}}var n=function(){o.e("components/empty").then(function(){return resolve(o("9511"))}.bind(null,o)).catch(o.oe)},i={components:{empty:n},data:function(){return{quxiaostate:0,shanchustate:0,tabCurrentIndex:0,showtip:!1,strtext:"",selId:"",coupon_code:"",coupon_code_show:!1,navList:[{state:-1,text:"全部",loadingType:"more",orderList:[]},{state:0,text:"待付款",loadingType:"more",orderList:[]},{state:1,text:"待发货",loadingType:"more",orderList:[]},{state:2,text:"待收货",loadingType:"more",orderList:[]},{state:3,text:"待评价",loadingType:"more",orderList:[]}]}},onLoad:function(t){this.quxiaostate=0,this.shanchustate=0,this.tabCurrentIndex=+t.state,0==t.state&&this.loadData(),this.loadData()},methods:{loadData:function(t){var e=this,o=this,a=this.tabCurrentIndex,n=this.navList[a],i=n.state;console.log("index=="+a),console.log("state=="+i),n.loadingType="loading",this.$Request.toget(this.$api.order.order_list,{status:-1==i?"":""+i},{authorization:this.$api_token}).then((function(a){console.log(a.message),1e3==a.code?setTimeout((function(){var i=a.content.filter((function(t){return t=Object.assign(t,o.orderStateExp(t.status,t.refund,t.refund_examine)),t}));"load"!=t?(n.orderList=[],i.forEach((function(t){n.orderList.push(t)}))):(n.orderList=[],i.forEach((function(t){n.orderList=t}))),e.$set(n,"loaded",!0),n.loadingType="noMore"}),300):(n.orderList=[],n.loadingType="noMore")})).catch((function(t){}))},change:function(t){t.show||(this.showtip=!1,this.coupon_code_show=!1)},cancel:function(e,o){var a=this;t.request({url:a.$api_url+"/refund.api",data:{openid:t.getStorageSync("openid"),id:a.selId,refund_reason:a.strtext},success:function(e){t.showToast({title:e.data.message}),a.showtip=!1,a.strtext="",a.loadData()}})},chsngetext:function(t){this.strtext=t.detail.value},toService:function(e){if(0==e.status&&t.navigateTo({url:"/pages/order/daizhifuOrder?id="+e.id}),4==e.status){var o="order/detail",a={orderId:e.id},n=this.$Request.topost(o,a);n.then((function(o){console.log(o),1e3==o.code?null!=o.content.order&&o.content.order.lastNum>0&&t.navigateTo({url:"/pages/order/daipinOrder?id="+e.id}):t.navigateBack()}))}},changeTab:function(t){this.tabCurrentIndex=t.target.current,this.loadData("tabChange")},tabClick:function(t){this.tabCurrentIndex=t},deleteOrder:function(e){var o=this,a=this;1!=a.shanchustate&&(a.shanchustate=1,t.showLoading({title:"请稍后"}),t.request({url:a.$api_url+"/order/delete",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:t.getStorageSync("authorization")},data:{orderNo:e.number},success:function(e){a.shanchustate=0,t.showToast({title:e.data.message}),t.hideLoading(),o.loadData()},complete:function(e){t.hideLoading()}}))},querenshouhuo:function(e){var o=this;t.showLoading({title:"请稍后"}),t.request({url:o.$api_url+"/order/confirm_single",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:t.getStorageSync("authorization")},data:{orderNo:e.id},success:function(e){t.showToast({title:e.data.message}),o.loadData()}})},cancelOrder:function(e){var o=this,a=this;1!=a.quxiaostate&&(a.quxiaostate=1,t.showLoading({title:"请稍后"}),t.request({url:a.$api_url+"/order/cancel",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:t.getStorageSync("authorization")},method:"POST",data:{orderNo:e.number},success:function(n){a.quxiaostate=0,setTimeout((function(){var n=a.orderStateExp(0,0,0),i=n.stateTip,r=n.stateTipColor;e=Object.assign(e,{state:0,stateTip:i,stateTipColor:r}),o.loadData(),t.hideLoading()}),300)},complete:function(e){t.hideLoading()}}))},pay:function(e){t.redirectTo({url:"/pages/money/pay?id="+e.id})},ping:function(e){t.redirectTo({url:"/pages/order/ping?id="+e.id})},refund:function(e){var o=this;t.showLoading({title:"请稍后"}),o.selId=e.id,t.request({url:o.$api_url+"/order/applyRefunding",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:t.getStorageSync("authorization")},data:{orderId:o.selId},success:function(e){t.showToast({title:e.data.message}),o.loadData()},complete:function(e){t.hideLoading()}})},quanma:function(t){this.coupon_code=t.coupon_code,this.coupon_code_show=!0},orderStateExp:function(t,e,o){var a="",n="#fa436a";switch(+t){case 0:a="待付款";break;case 1:case 4:a="待发货";break;case 2:a="待收货";break;case 3:a="已完成";break;case 6:a="已退款";break;case 9:a="已驳回";break;case 5:a="退款中";break;case 7:a="订单已取消",n="#909399";break;case 8:a="订单已删除",n="#909399";break;case 10:a="已评价";break}return{stateTip:a,stateTipColor:n}}}};e.default=i}).call(this,o("543d")["default"])},"2ac2":function(t,e,o){"use strict";(function(t){o("c6bf"),o("921b");a(o("66fd"));var e=a(o("7adc"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},"498f":function(t,e,o){"use strict";o.r(e);var a=o("28cd"),n=o.n(a);for(var i in a)"default"!==i&&function(t){o.d(e,t,(function(){return a[t]}))}(i);e["default"]=n.a},"5fa0":function(t,e,o){"use strict";var a={"uni-load-more":function(){return o.e("components/uni-load-more/uni-load-more").then(o.bind(null,"2f0f"))},"uni-popup":function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"5662"))}},n=function(){var t=this,e=t.$createElement;t._self._c},i=[];o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return a}))},"7adc":function(t,e,o){"use strict";o.r(e);var a=o("5fa0"),n=o("498f");for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);o("8c08");var r,s=o("f0c5"),u=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);e["default"]=u.exports},"8c08":function(t,e,o){"use strict";var a=o("9710"),n=o.n(a);n.a},9710:function(t,e,o){}},[["2ac2","common/runtime","common/vendor"]]]);