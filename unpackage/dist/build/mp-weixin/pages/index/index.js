(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{5632:function(o,t,n){"use strict";(function(o){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={data:function(){return{cityname:"请登录",top_alpha:"background-color: rgba(255,255,255,1);",banner:[],miaosha_show:!1,navlist:[],juli:"据开始",juhuasuanlist:[],couponlist:[],product_app_list:[],get_activity:[],kaiqiang_time:"00:00",hours:"00",minutes:"00",second:"00",secondsKillVO:[],categoryList:[],brand_recommend_list:[],specialVos:[],schemeIsRecommendedVos:[],page:1,loadingType:0,location:"",contentText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},appid:"wx1e036895e60e3a06"}},methods:{loadBanner:function(o){var t=this,n=this;n.$Request.toget1(n.$api.home.banner,{appId:n.appId,location:n.location}).then((function(o){1e3==o.code&&(n.banner=o.content.advertisementVos,n.brand_recommend_list=o.content.brandRecommendationVos,n.specialVos=o.content.specialVos,n.schemeIsRecommendedVos=o.content.schemeIsRecommendedVos,n.categoryList=o.content.categoryList)})),n.$Request.toget1(n.$api.home.get_activity,{appId:n.appId,location:n.location}).then((function(o){if(1e3==o.code){if(null==o.content.secondsKillVO)return;console.log(JSON.stringify(o.content.secondsKillVO)),n.secondsKillVO=o.content.secondsKillVO;var t=new Date(o.content.secondsKillVO.startTime),e=t.getHours();e=e<10?"0"+e:e;var a=t.getMinutes();a=a<10?"0"+a:a,n.kaiqiang_time=e+":"+a;var i=new Date(o.content.secondsKillVO.endTime),c=i.getHours(),s=i.getMinutes();n.kaiqiang_endtime=c+":"+s,n.intervalID=setInterval((function(){var o=new Date,e=(t-o)/1e3;if(n.miaosha_show=!0,e>0){n.miaosha_show=!0;var a=parseInt(e/86400),c=parseInt(e/3600)-24*a,s=parseInt(e%3600/60),l=parseInt(e%60);n.hours=c<10?"0"+c:c,n.minutes=s<10?"0"+s:s,n.second=l<10?"0"+l:l}else{n.juli="距结束";o=new Date,e=(i-o)/1e3;e>0?n.miaosha_show=!0:(clearInterval(n.intervalID),n.miaosha_show=!1);a=parseInt(e/86400),c=parseInt(e/3600)-24*a,s=parseInt(e%3600/60),l=parseInt(e%60);n.hours=c<10?"0"+c:c,n.minutes=s<10?"0"+s:s,n.second=l<10?"0"+l:l}}),1e3)}})),this.$Request.topost1(this.$api.home.group_buy,{appId:n.appId,location:n.location}).then((function(o){1e3==o.code&&(t.get_activity=o.content)}))},loadNavList:function(){var o=this,t=this.$SysCache.get("app_index_navlist");t?this.navlist=t:this.$Request.post1(this.$api.home.navlist,{appId:n.appId,location:n.location}).then((function(t){200==t.code&&(o.navlist=t.data,o.$SysCache.put("app_index_navlist",t.data,86400))}))},loadJuhuasuanlist:function(){},loadCouponList:function(t){var e=this;1==this.page&&(this.product_app_list=[]),this.loadingType=1,this.$Request.toget1(this.$api.home.get_product_app_list,{appId:n.appId,location:n.location,pageNum:this.page,pageSize:10}).then((function(n){e.loadingType=0,1e3==n.code?(e.page=e.page+1,n.content.productListAppVoList.forEach((function(o){e.product_app_list.push(o),console.log("eeee"+o)}))):e.loadingType=2,"Refresh"==t&&o.stopPullDownRefresh()})).catch((function(o){}))},toNavList:function(t,n){o.showToast({title:n,mask:!1,duration:1500,icon:"none"})},toCategory:function(t,n){var e=o.getStorageSync("authorization");""!=e&&null!=e?o.navigateTo({url:"/pages/category/category?categoryId="+t}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toZhouqigou:function(){var t=o.getStorageSync("authorization");""!=t&&null!=t?o.navigateTo({url:"/pages/category/zhouqigou"}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toTaocan:function(){var t=o.getStorageSync("authorization");""!=t&&null!=t?o.navigateTo({url:"/pages/category/taocan"}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toPintuan:function(){var t=o.getStorageSync("authorization");""!=t&&null!=t?o.navigateTo({url:"/pages/category/pintuan?location="+n.location}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toMiaoSha:function(){var t=o.getStorageSync("authorization");""!=t&&null!=t?o.navigateTo({url:"/pages/index/miaosha"}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toGoodsInfo:function(t,n){var e=o.getStorageSync("authorization");""!=e&&null!=e?o.navigateTo({url:"/pages/detail/goodsinfo?id="+t+"&type="+n}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toSearchIndex:function(){var t=o.getStorageSync("authorization");""!=t&&null!=t?o.navigateTo({url:"/pages/search/index?location="+n.location}):o.showModal({cancelText:"取消登录",confirmText:"立即登录",title:"提示",content:"是否确定授权登录？",success:function(t){t.confirm?o.navigateTo({url:"../myinfo/login"}):t.cancel&&console.log("用户点击取消")}})},toZujiIndex:function(){var t=o.getStorageSync("authorization");""!=t&&null!=t&&o.chooseAddress({success:function(t){var e=t.cityName;o.request({url:n.$api_url+"/user/login/loginLocation",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:o.getStorageSync("authorization")},data:{location:t.provinceName+t.cityName+t.countyName+t.detailInfo,type:2},success:function(t){1e3==t.data.code&&(o.setStorageSync("Location",e),n.cityname=e,t.data.content&&(n.location=""+t.data.content),n.loadBanner(),n.loadNavList(),n.loadJuhuasuanlist(),n.loadCouponList())}})}})},getSettingMess:function(){o.getSetting({success:function(t){if(t.authSetting["scope.userLocation"]){if(console.log("userLocation位置功能已授权"),"请登录"!=n.cityname)return;o.getLocation({type:"wgs84",success:function(t){console.log("当前位置的经度："+t.longitude),console.log("当前位置的纬度："+t.latitude),n.location=t.latitude+","+t.longitude,n.loadBanner(),n.loadNavList(),n.loadJuhuasuanlist(),n.loadCouponList(),n.location=t.latitude+","+t.longitude,o.request({url:n.$api_url+"/user/login/loginLocation",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:o.getStorageSync("authorization")},data:{location:t.latitude+","+t.longitude,type:"1"},success:function(t){console.log(t),1e3==t.data.code&&(o.setStorageSync("Location",t.data.content.city),n.cityname=t.data.content.city)}})}})}else t.authSetting["scope.userLocation"]||o.authorize({scope:"scope.userLocation",success:function(t){console.log(t),"请登录"==n.cityname&&o.getLocation({type:"wgs84",success:function(t){console.log("当前位置的经度："+t.longitude),console.log("当前位置的纬度："+t.latitude),n.location=t.latitude+","+t.longitude,n.loadBanner(),n.loadNavList(),n.loadJuhuasuanlist(),n.loadCouponList(),n.location=t.latitude+","+t.longitude,o.request({url:n.$api_url+"/user/login/loginLocation",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:o.getStorageSync("authorization")},data:{location:t.latitude+","+t.longitude,type:"1"},success:function(t){console.log(t),1e3==t.data.code&&(o.setStorageSync("Location",t.data.content.city),n.cityname=t.data.content.city)}})}})},fail:function(){console.log("位置授权失败23"),o.showModal({title:"是否打开设置页？",content:"需要在设置中获取当前位置信息权限，方便为你推选更多好货。",success:function(t){t.confirm?o.openSetting({success:function(o){o.authSetting["scope.userLocation"]?console.log("手动授权成功"):console.log("手动授权失败")},fail:function(){console.log("打开设置页面失败")}}):t.cancel&&console.log("用户点击取消")},fail:function(){console.log("确认取消弹出未弹出")}})}})},fail:function(){console.log("获取授权信息授权失败")}})},handleLocation:function(){o.getSetting({success:function(t){if(t.authSetting["scope.userLocation"]){if("请登录"!=n.cityname)return;o.getLocation({type:"wgs84",success:function(t){console.log("当前位置的经度："+t.longitude),console.log("当前位置的纬度："+t.latitude),n.location=t.latitude+","+t.longitude,n.loadBanner(),n.loadNavList(),n.loadJuhuasuanlist(),n.loadCouponList(),n.location=t.latitude+","+t.longitude,o.request({url:n.$api_url+"/user/login/loginLocation",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",authorization:o.getStorageSync("authorization")},data:{location:t.latitude+","+t.longitude,type:"1"},success:function(t){console.log(t),1e3==t.data.code&&(o.setStorageSync("Location",t.data.content.city),n.cityname=t.data.content.city)}})}})}else t.authSetting["scope.userLocation"]||o.showModal({title:"是否打开设置页？",content:"需要在设置中获取xx信息和xx权限",success:function(t){t.confirm?o.openSetting({success:function(o){o.authSetting["scope.userLocation"]?console.log("手动授权成功"):console.log("手动授权失败")},fail:function(){console.log("打开设置页面失败")}}):t.cancel&&console.log("用户点击取消")},fail:function(){console.log("确认取消弹出未弹出")}})},fail:function(){console.log("获取已授权信息失败")}})}},onReady:function(){},onShow:function(t){o.request({url:this.$api_url+"/notify/count",method:"GET",header:{authorization:o.getStorageSync("authorization")},success:function(t){if(console.log(t),2002==t.data.code)try{o.clearStorageSync()}catch(n){console.log("清除缓存错误："+n)}}}),this.getSettingMess()},onHide:function(o){},onLoad:function(){n=this;var t=o.getAccountInfoSync();n.appId=t.miniProgram.appId},onReachBottom:function(){this.loadCouponList()},onPullDownRefresh:function(){}};t.default=e}).call(this,n("543d")["default"])},"86e3":function(o,t,n){"use strict";var e=n("d2c4"),a=n.n(e);a.a},b4d8:function(o,t,n){"use strict";var e,a=function(){var o=this,t=o.$createElement,n=(o._self._c,o.cityname.substring(0,2));o.$mp.data=Object.assign({},{$root:{g0:n}})},i=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return e}))},d144:function(o,t,n){"use strict";n.r(t);var e=n("5632"),a=n.n(e);for(var i in e)"default"!==i&&function(o){n.d(t,o,(function(){return e[o]}))}(i);t["default"]=a.a},d220:function(o,t,n){"use strict";(function(o){n("c6bf"),n("921b");e(n("66fd"));var t=e(n("dfc3"));function e(o){return o&&o.__esModule?o:{default:o}}o(t.default)}).call(this,n("543d")["createPage"])},d2c4:function(o,t,n){},dfc3:function(o,t,n){"use strict";n.r(t);var e=n("b4d8"),a=n("d144");for(var i in a)"default"!==i&&function(o){n.d(t,o,(function(){return a[o]}))}(i);n("86e3");var c,s=n("f0c5"),l=Object(s["a"])(a["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],c);t["default"]=l.exports}},[["d220","common/runtime","common/vendor"]]]);